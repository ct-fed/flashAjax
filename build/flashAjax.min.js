var swfobject=function(){function e(){if(!W){try{var e=M.getElementsByTagName("body")[0].appendChild(h("span"));e.parentNode.removeChild(e)}catch(t){return}W=!0;for(var n=G.length,a=0;n>a;a++)G[a]()}}function t(e){W?e():G[G.length]=e}function n(e){if(typeof $.addEventListener!=j)$.addEventListener("load",e,!1);else if(typeof M.addEventListener!=j)M.addEventListener("load",e,!1);else if(typeof $.attachEvent!=j)m($,"onload",e);else if("function"==typeof $.onload){var t=$.onload;$.onload=function(){t(),e()}}else $.onload=e}function a(){R?i():r()}function i(){var e=M.getElementsByTagName("body")[0],t=h(F);t.setAttribute("type",k);var n=e.appendChild(t);if(n){var a=0;!function(){if(typeof n.GetVariable!=j){var i=n.GetVariable("$version");i&&(i=i.split(" ")[1].split(","),X.pv=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)])}else if(10>a)return a++,void setTimeout(arguments.callee,10);e.removeChild(t),n=null,r()}()}else r()}function r(){var e=P.length;if(e>0)for(var t=0;e>t;t++){var n=P[t].id,a=P[t].callbackFn,i={success:!1,id:n};if(X.pv[0]>0){var r=y(n);if(r)if(!g(P[t].swfVersion)||X.wk&&X.wk<312)if(P[t].expressInstall&&l()){var f={};f.data=P[t].expressInstall,f.width=r.getAttribute("width")||"0",f.height=r.getAttribute("height")||"0",r.getAttribute("class")&&(f.styleclass=r.getAttribute("class")),r.getAttribute("align")&&(f.align=r.getAttribute("align"));for(var d={},u=r.getElementsByTagName("param"),p=u.length,v=0;p>v;v++)"movie"!=u[v].getAttribute("name").toLowerCase()&&(d[u[v].getAttribute("name")]=u[v].getAttribute("value"));s(f,d,n,a)}else c(r),a&&a(i);else b(n,!0),a&&(i.success=!0,i.ref=o(n),a(i))}else if(b(n,!0),a){var h=o(n);h&&typeof h.SetVariable!=j&&(i.success=!0,i.ref=h),a(i)}}}function o(e){var t=null,n=y(e);if(n&&"OBJECT"==n.nodeName)if(typeof n.SetVariable!=j)t=n;else{var a=n.getElementsByTagName(F)[0];a&&(t=a)}return t}function l(){return!H&&g("6.0.65")&&(X.win||X.mac)&&!(X.wk&&X.wk<312)}function s(e,t,n,a){H=!0,A=a||null,T={success:!1,id:n};var i=y(n);if(i){"OBJECT"==i.nodeName?(S=f(i),E=null):(S=i,E=n),e.id=B,(typeof e.width==j||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==j||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),M.title=M.title.slice(0,47)+" - Flash Player Installation";var r=X.ie&&X.win?"ActiveX":"PlugIn",o="MMredirectURL="+$.location.toString().replace(/&/g,"%26")+"&MMplayerType="+r+"&MMdoctitle="+M.title;if(typeof t.flashvars!=j?t.flashvars+="&"+o:t.flashvars=o,X.ie&&X.win&&4!=i.readyState){var l=h("div");n+="SWFObjectNew",l.setAttribute("id",n),i.parentNode.insertBefore(l,i),i.style.display="none",function(){4==i.readyState?i.parentNode.removeChild(i):setTimeout(arguments.callee,10)}()}d(e,t,n)}}function c(e){if(X.ie&&X.win&&4!=e.readyState){var t=h("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(f(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(f(e),e)}function f(e){var t=h("div");if(X.win&&X.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(F)[0];if(n){var a=n.childNodes;if(a)for(var i=a.length,r=0;i>r;r++)1==a[r].nodeType&&"PARAM"==a[r].nodeName||8==a[r].nodeType||t.appendChild(a[r].cloneNode(!0))}}return t}function d(e,t,n){var a,i=y(n);if(X.wk&&X.wk<312)return a;if(i)if(typeof e.id==j&&(e.id=n),X.ie&&X.win){var r="";for(var o in e)e[o]!=Object.prototype[o]&&("data"==o.toLowerCase()?t.movie=e[o]:"styleclass"==o.toLowerCase()?r+=' class="'+e[o]+'"':"classid"!=o.toLowerCase()&&(r+=" "+o+'="'+e[o]+'"'));var l="";for(var s in t)t[s]!=Object.prototype[s]&&(l+='<param name="'+s+'" value="'+t[s]+'" />');i.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+r+">"+l+"</object>",D[D.length]=e.id,a=y(e.id)}else{var c=h(F);c.setAttribute("type",k);for(var f in e)e[f]!=Object.prototype[f]&&("styleclass"==f.toLowerCase()?c.setAttribute("class",e[f]):"classid"!=f.toLowerCase()&&c.setAttribute(f,e[f]));for(var d in t)t[d]!=Object.prototype[d]&&"movie"!=d.toLowerCase()&&u(c,d,t[d]);i.parentNode.replaceChild(c,i),a=c}return a}function u(e,t,n){var a=h("param");a.setAttribute("name",t),a.setAttribute("value",n),e.appendChild(a)}function p(e){var t=y(e);t&&"OBJECT"==t.nodeName&&(X.ie&&X.win?(t.style.display="none",function(){4==t.readyState?v(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function v(e){var t=y(e);if(t){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode.removeChild(t)}}function y(e){var t=null;try{t=M.getElementById(e)}catch(n){}return t}function h(e){return M.createElement(e)}function m(e,t,n){e.attachEvent(t,n),U[U.length]=[e,t,n]}function g(e){var t=X.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function w(e,t,n,a){if(!X.ie||!X.mac){var i=M.getElementsByTagName("head")[0];if(i){var r=n&&"string"==typeof n?n:"screen";if(a&&(I=null,N=null),!I||N!=r){var o=h("style");o.setAttribute("type","text/css"),o.setAttribute("media",r),I=i.appendChild(o),X.ie&&X.win&&typeof M.styleSheets!=j&&M.styleSheets.length>0&&(I=M.styleSheets[M.styleSheets.length-1]),N=r}X.ie&&X.win?I&&typeof I.addRule==F&&I.addRule(e,t):I&&typeof M.createTextNode!=j&&I.appendChild(M.createTextNode(e+" {"+t+"}"))}}}function b(e,t){if(J){var n=t?"visible":"hidden";W&&y(e)?y(e).style.visibility=n:w("#"+e,"visibility:"+n)}}function C(e){var t=/[\\\"<>\.;]/,n=null!=t.exec(e);return n&&typeof encodeURIComponent!=j?encodeURIComponent(e):e}{var S,E,A,T,I,N,j="undefined",F="object",x="Shockwave Flash",L="ShockwaveFlash.ShockwaveFlash",k="application/x-shockwave-flash",B="SWFObjectExprInst",O="onreadystatechange",$=window,M=document,V=navigator,R=!1,G=[a],P=[],D=[],U=[],W=!1,H=!1,J=!0,X=function(){var e=typeof M.getElementById!=j&&typeof M.getElementsByTagName!=j&&typeof M.createElement!=j,t=V.userAgent.toLowerCase(),n=V.platform.toLowerCase(),a=/win/.test(n?n:t),i=/mac/.test(n?n:t),r=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,o=!1,l=[0,0,0],s=null;if(typeof V.plugins!=j&&typeof V.plugins[x]==F)s=V.plugins[x].description,!s||typeof V.mimeTypes!=j&&V.mimeTypes[k]&&!V.mimeTypes[k].enabledPlugin||(R=!0,o=!1,s=s.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),l[0]=parseInt(s.replace(/^(.*)\..*$/,"$1"),10),l[1]=parseInt(s.replace(/^.*\.(.*)\s.*$/,"$1"),10),l[2]=/[a-zA-Z]/.test(s)?parseInt(s.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof $.ActiveXObject!=j)try{var c=new ActiveXObject(L);c&&(s=c.GetVariable("$version"),s&&(o=!0,s=s.split(" ")[1].split(","),l=[parseInt(s[0],10),parseInt(s[1],10),parseInt(s[2],10)]))}catch(f){}return{w3:e,pv:l,wk:r,ie:o,win:a,mac:i}}();!function(){X.w3&&((typeof M.readyState!=j&&"complete"==M.readyState||typeof M.readyState==j&&(M.getElementsByTagName("body")[0]||M.body))&&e(),W||(typeof M.addEventListener!=j&&M.addEventListener("DOMContentLoaded",e,!1),X.ie&&X.win&&(M.attachEvent(O,function(){"complete"==M.readyState&&(M.detachEvent(O,arguments.callee),e())}),$==top&&!function(){if(!W){try{M.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e()}}()),X.wk&&!function(){return W?void 0:/loaded|complete/.test(M.readyState)?void e():void setTimeout(arguments.callee,0)}(),n(e)))}(),function(){X.ie&&X.win&&window.attachEvent("onunload",function(){for(var e=U.length,t=0;e>t;t++)U[t][0].detachEvent(U[t][1],U[t][2]);for(var n=D.length,a=0;n>a;a++)p(D[a]);for(var i in X)X[i]=null;X=null;for(var r in swfobject)swfobject[r]=null;swfobject=null})}()}return{registerObject:function(e,t,n,a){if(X.w3&&e&&t){var i={};i.id=e,i.swfVersion=t,i.expressInstall=n,i.callbackFn=a,P[P.length]=i,b(e,!1)}else a&&a({success:!1,id:e})},getObjectById:function(e){return X.w3?o(e):void 0},embedSWF:function(e,n,a,i,r,o,c,f,u,p){var v={success:!1,id:n};X.w3&&!(X.wk&&X.wk<312)&&e&&n&&a&&i&&r?(b(n,!1),t(function(){a+="",i+="";var t={};if(u&&typeof u===F)for(var y in u)t[y]=u[y];t.data=e,t.width=a,t.height=i;var h={};if(f&&typeof f===F)for(var m in f)h[m]=f[m];if(c&&typeof c===F)for(var w in c)typeof h.flashvars!=j?h.flashvars+="&"+w+"="+c[w]:h.flashvars=w+"="+c[w];if(g(r)){var C=d(t,h,n);t.id==n&&b(n,!0),v.success=!0,v.ref=C}else{if(o&&l())return t.data=o,void s(t,h,n,p);b(n,!0)}p&&p(v)})):p&&p(v)},switchOffAutoHideShow:function(){J=!1},ua:X,getFlashPlayerVersion:function(){return{major:X.pv[0],minor:X.pv[1],release:X.pv[2]}},hasFlashPlayerVersion:g,createSWF:function(e,t,n){return X.w3?d(e,t,n):void 0},showExpressInstall:function(e,t,n,a){X.w3&&l()&&s(e,t,n,a)},removeSWF:function(e){X.w3&&p(e)},createCSS:function(e,t,n,a){X.w3&&w(e,t,n,a)},addDomLoadEvent:t,addLoadEvent:n,getQueryParamValue:function(e){var t=M.location.search||M.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return C(t);for(var n=t.split("&"),a=0;a<n.length;a++)if(n[a].substring(0,n[a].indexOf("="))==e)return C(n[a].substring(n[a].indexOf("=")+1))}return""},expressInstallCallback:function(){if(H){var e=y(B);e&&S&&(e.parentNode.replaceChild(S,e),E&&(b(E,!0),X.ie&&X.win&&(S.style.display="block")),A&&A(T)),H=!1}}}}();!function(e){var t=e.flashAjax;if(!t){t=function(e){var t=a.createGuid();u(t,e),v(t)};var n,a={createGuid:function(){return"_"+Math.random().toString(36).slice(2)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}},i={url:"",type:"GET",dataType:"",data:{},flashUrl:"",onReady:function(){},onSuccess:function(){},onFail:function(){},onComplete:function(){}},r=function(t){if(!n){n=a.createGuid();var i=a.createGuid();e("body").prepend('<div style="position: absolute;top:-100px;left:0;"><div id="'+i+'"/></div>'),swfobject.embedSWF(p(t).flashUrl+"?"+(new Date).getTime(),i,"1","1","9.0.0","expressInstall.swf",{connectName:"$.flashAjax.onConnect"},{allowFullscreen:"true",allowScriptAccess:"always"},{id:n,name:n})}},o=function(){return document.getElementById(n)},l=!1,s=[],c=function(){e.each(s,function(e,t){f(t,p(t).onReady)}),s=[]},f=function(e,t){a.isFunction(t)&&t()===!1||y(e)};t.onConnect=function(){l=!0,o().asParam("$.flashAjax.onSuccess","$.flashAjax.onFail","$.flashAjax.onComplete"),c()},t.onSuccess=function(e,t){p(t).onSuccess(e)},t.onFail=function(e,t){p(t).onFail(e.msg)},t.onComplete=function(e){p(e).onComplete()};var d={},u=function(t,n){d[t]=e.extend(i,n)},p=function(e){return d[e]},v=function(e){var t=p(e);return t.url?t.flashUrl?l?void f(e,t.onReady):(s.push(e),void r(e)):void t.onFail("请配置swf文件地址"):void t.onFail("请配置接口地址")},y=function(e){var t=p(e);o().asSend({url:t.url,data:t.data,type:t.type,dataType:t.dataType,maskId:e})};e.flashAjax=t}}(jQuery);